(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c1cd9308"],{"36b6":function(t,e,s){},"3c4a":function(t,e,s){"use strict";s("36b6")},"92bc":function(t,e,s){"use strict";s.d(e,"l",(function(){return n})),s.d(e,"i",(function(){return a})),s.d(e,"a",(function(){return r})),s.d(e,"s",(function(){return i})),s.d(e,"f",(function(){return l})),s.d(e,"q",(function(){return c})),s.d(e,"k",(function(){return u})),s.d(e,"b",(function(){return d})),s.d(e,"o",(function(){return f})),s.d(e,"j",(function(){return p})),s.d(e,"h",(function(){return m})),s.d(e,"g",(function(){return A})),s.d(e,"e",(function(){return h})),s.d(e,"d",(function(){return v})),s.d(e,"u",(function(){return _})),s.d(e,"p",(function(){return b})),s.d(e,"t",(function(){return g})),s.d(e,"n",(function(){return w})),s.d(e,"c",(function(){return k})),s.d(e,"m",(function(){return y})),s.d(e,"r",(function(){return x}));var o=s("b775");function n(t){return Object(o["a"])({url:"/system/wf/flow/list",method:"get",params:t})}function a(t){return Object(o["a"])({url:"/system/wf/flow/edit?id="+t,method:"get"})}function r(t){return Object(o["a"])({url:"/system/wf/flow/add",method:"post",data:t})}function i(t){return Object(o["a"])({url:"/system/wf/flow/edit",method:"post",data:t})}function l(t){return Object(o["a"])({url:"/system/wf/flow/delete",method:"delete",data:{ids:t}})}function c(t){return Object(o["a"])({url:"/system/wf/flow/statusSetFlow",method:"post",data:t})}function u(t){return Object(o["a"])({url:"/system/wf/flow/designFlow?id="+t,method:"get"})}function d(t){return Object(o["a"])({url:"/system/wf/flow/addProcess",method:"post",data:{id:t}})}function f(t){return Object(o["a"])({url:"/system/wf/flow/saveProcess",method:"post",data:{data:t}})}function p(t){return Object(o["a"])({url:"/system/wf/flow/getManager",method:"post",data:t})}function m(t){return Object(o["a"])({url:"/system/wf/flow/saveAttr",method:"post",data:t})}function A(t){return Object(o["a"])({url:"/system/wf/flow/deleteProcess",method:"delete",data:t})}function h(t){return Object(o["a"])({url:"/system/wf/flow/deleteProcessAll",method:"delete",data:t})}function v(t){return Object(o["a"])({url:"/system/wf/flow/checkFlow",method:"get",params:t})}function _(t){return Object(o["a"])({url:"/system/wf/flow/wfStart",method:"get",params:t})}function b(t){return Object(o["a"])({url:"/system/wf/flow/saveStartWf",method:"post",params:t})}function g(t){return Object(o["a"])({url:"/system/wf/flow/wfCheck",method:"get",params:t})}function w(t){return Object(o["a"])({url:"/system/wf/flow/checkSave",method:"post",data:t})}function k(t){return Object(o["a"])({url:"/system/wf/flow/getBackTodo",method:"get",params:t})}function y(t){return Object(o["a"])({url:"/system/wf/flow/monitoring",method:"get",params:t})}function x(t){return Object(o["a"])({url:"/system/wf/flow/stopFlow",method:"put",data:t})}},a51c:function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.isRouterAlive?s("workFlow",{ref:"design",attrs:{tableFields:t.tableFields,processList:t.processList,ManagerData:t.manager,processStep:t.processStep},on:{deleteFlowNode:t.deleteFlowNode,getProcessData:t.getProcessData,setProcessList:t.setProcessList,saveProcess:t.saveProcess,addProcess:t.addProcess,getManager:t.getManager,doSaveAttr:t.doSaveAttr,clearAllNodes:t.clearAllNodes,checkFlow:t.checkFlow}}):t._e()},n=[],a=(s("96cf"),s("3b8d")),r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flow-layout"},[s("div",{staticClass:"flow-toolbar"},[s("h3",{staticClass:"title-head"},[t._v("功能栏")]),t._v(" "),s("el-row",{staticClass:"tool-btn"},[s("el-button",{attrs:{type:"success",plain:""},on:{click:t.saveProcess}},[t._v("保存设计")]),t._v(" "),s("el-button",{attrs:{type:"primary",plain:""},on:{click:t.addProcess}},[t._v("新增步骤")]),t._v(" "),s("el-button",{attrs:{type:"warning",plain:""},on:{click:t.checkFlow}},[t._v("逻辑检查")]),t._v(" "),s("el-button",{attrs:{type:"danger",plain:""},on:{click:t.clearAllNodes}},[t._v("清空步骤")]),t._v(" "),s("el-button",{attrs:{plain:""},on:{click:t.wfRefresh}},[t._v("刷新设计")])],1)],1),t._v(" "),s("div",{staticClass:"flow-design"},[s("h3",{staticClass:"title-head"},[t._v("流程设计栏")]),t._v(" "),s("div",{staticClass:"flow-editor"},[s("div",{staticClass:"flow-zoom",attrs:{"data-zoom":t.canvasDataRoom+"%"}},[s("div",{staticClass:"zoom-btn"},[s("el-button",{class:{"el-button--primary":t.canvasRoomMinusEnable},attrs:{size:"mini",icon:"el-icon-minus",circle:""},on:{click:t.handleMinusCanvas}})],1),t._v(" "),s("div",{staticClass:"zoom-btn"},[s("el-button",{class:{"el-button--primary":t.canvasRoomPlusEnable},attrs:{size:"mini",icon:"el-icon-plus",circle:""},on:{click:t.handlePlusCanvas}})],1)]),t._v(" "),s("div",{staticClass:"canvas-container",attrs:{"data-zoom":t.canvasDataRoom}},[s("div",{ref:"campaignCanvas",style:t.canvasRoomScaleStyle,attrs:{id:"campaignCanvas"}},[t._l(t.processListTmp,(function(e,o){return[s("div",{key:e.id,staticClass:"process-step wf_btn ui-draggable ui-droppable",style:e.style+"text-align: left;",attrs:{id:"window"+e.id,process_to:e.process_to,process_id:e.id},on:{dblclick:function(s){return t.deleteNode(e.id)},mousedown:function(e){t.clk=!0},click:function(s){return t.showAttr(e.id)}}},[s("span",{staticClass:"process-flag",staticStyle:{"text-align":"left"},attrs:{id:"flag"+e.id}},[s("img",{attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAQAAABKfvVzAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQfbBRIXBAD72CbZAAADCElEQVQ4y13US2xVZRSG4effe7elFGhpoVWgUArtQe5XkUg0BC8hkagQExPjAAIDB4wcOXFg4tihA2Vk1IEaBt5RxEaDYmtTqglIa0hpS1qIRWiF9pzu8zvoCRi/2cq6fMmbtVZQ0UGoVbDDPgUrBCMGdPklXtp751WZALJKKaxzxBOxPaSVuFOnA4bCmdmPs4szN09rskNWSdY57FjcVhOabUlXpU2BiTicX8jH1jR2HHp28puBN9PhkTkH1HnFidi0NjxVtTtbGKoqU0pVU7FvtikptDu+suHaib03SA/CS15LFj+SHqvZldWGVMkd0xLVasPqtCUJ8tDd9snohp5haYG1Xrd2T3K0ZkUaRcGfTjlvvmUiAnpnT8axpd/97Eai2svl7e1erG5Joku63HXHkCtuyZ3Tq4wHksXRNkfVZtY5UJPuz9pSBp1y3aQmqUTJDz5TJ7HViuTpqqFi8UkfZLbFjua4J4OoqKRLs5Kgx5S7MmUBu7LPi1fa7E7sC+nGtD6ZA/+C5WaMmBGNmdTokB1gYdicCvZlNtORVqHPNdE8iVjBGtQa94VGO2U6UiVbMi3UB+jRLUgl7mvUVbmCLTKLAlqy+8kFGiVm3b3nwHzVcosqezS3S+MW3orwqI1mnDPwH4elHrPAfNW4HTGe6GcwL6FVwd9GlAUBQTRuXLt2iVmDOfoTXTH/LZ/z+N3XpjTYoFai04Omfa9HxGS8kIvOJn4NA9fDTyVYbo0Gz9gpKFvvOc1WahPQPTvKkPOZS76cWXfGprQtbfa8CQX9FagbzFOtFSPl06VpybcupoXcSNh1c/mtcke6INRZIigJlum0RKN6/FX+sNhbDn3ecC0tMIE9ozXXy61JQwL1HrLJkgqp4fJ7Mz/m5X+85SvSywoMyOPm4drBnMYkC0mFe8lkPDf7frE3xtve9q7ip0Llpuscdjxur4kttqat6dLARLya9+VjpkO44B0fmeJ+A6x3xP64+t4TgLKrzjpZ4TDX8L8387DHdVolGHHZWd3+mJs9p38BQHkS326FepQAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDYtMjhUMjI6Mzg6MjQrMDg6MDCBECHGAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDExLTA1LTE4VDIzOjA0OjAwKzA4OjAwRsh68wAAAEN0RVh0c29mdHdhcmUAL3Vzci9sb2NhbC9pbWFnZW1hZ2ljay9zaGFyZS9kb2MvSW1hZ2VNYWdpY2stNy8vaW5kZXguaHRtbL21eQoAAAAYdEVYdFRodW1iOjpEb2N1bWVudDo6UGFnZXMAMaf/uy8AAAAXdEVYdFRodW1iOjpJbWFnZTo6SGVpZ2h0ADMyKPT49AAAABZ0RVh0VGh1bWI6OkltYWdlOjpXaWR0aAAzMtBbOHkAAAAZdEVYdFRodW1iOjpNaW1ldHlwZQBpbWFnZS9wbmc/slZOAAAAF3RFWHRUaHVtYjo6TVRpbWUAMTMwNTczMTA0MJzV/YIAAAARdEVYdFRodW1iOjpTaXplADEzMzhCRu5XfwAAAGB0RVh0VGh1bWI6OlVSSQBmaWxlOi8vL2hvbWUvd3d3cm9vdC9uZXdzaXRlL3d3dy5lYXN5aWNvbi5uZXQvY2RuLWltZy5lYXN5aWNvbi5jbi9zcmMvNTA0Ny81MDQ3NTMucG5nxUdQRAAAAABJRU5ErkJggg==",width:"18px"}})]),t._v(" "),s("span",{domProps:{innerHTML:t._s(e.process_name)}}),s("br"),t._v(" "),s("img",{attrs:{src:"data:image/png;base64,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eJWkknqeCfn8YZt9h27yjSowQmiHpKBpTZtzGCy7U18ibfIBwTI69UfaJx6DFiPW/xb/b/gP8zuk/2nab5kAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTktMDEtMDlUMDM6NTg6MTMrMDg6MDA5NyEdAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE5LTAxLTA5VDAzOjU4OjEzKzA4OjAwSGqZoQAAAEN0RVh0c29mdHdhcmUAL3Vzci9sb2NhbC9pbWFnZW1hZ2ljay9zaGFyZS9kb2MvSW1hZ2VNYWdpY2stNy8vaW5kZXguaHRtbL21eQoAAABjdEVYdHN2Zzpjb21tZW50ACBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIM5IkAsAAAAYdEVYdFRodW1iOjpEb2N1bWVudDo6UGFnZXMAMaf/uy8AAAAYdEVYdFRodW1iOjpJbWFnZTo6SGVpZ2h0ADU1MXLoxz8AAAAXdEVYdFRodW1iOjpJbWFnZTo6V2lkdGgANTUx4RmXYgAAABl0RVh0VGh1bWI6Ok1pbWV0eXBlAGltYWdlL3BuZz+yVk4AAAAXdEVYdFRodW1iOjpNVGltZQAxNTQ2OTc3NDkzmyKPKAAAABJ0RVh0VGh1bWI6OlNpemUAMzE4NjFCZKk/ngAAAGJ0RVh0VGh1bWI6OlVSSQBmaWxlOi8vL2hvbWUvd3d3cm9vdC9uZXdzaXRlL3d3dy5lYXN5aWNvbi5uZXQvY2RuLWltZy5lYXN5aWNvbi5jbi9maWxlcy8xMjAvMTIwMTMzNy5wbmfCdaGGAAAAAElFTkSuQmCC",width:"18px"}}),t._v(" "),s("span",{domProps:{innerHTML:t._s(e.mode)}}),s("br"),t._v(" "),s("img",{attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAxCAYAAACcXioiAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAAD9AAAA/QCVfLMFAAAAB3RJTUUH4wEJAzcWevkOigAABRFJREFUaN7N2mmoVVUUB/DfUx9laaXNIRGVaVHUS3vSZJQRkUhzFg00CFGZUV8qkigriqBIKaPpQ0WQDahpHyKTRtMnZfNoijaYCmVmmaXPPqx95XA69/nuufe+14LLhXPu3vv/33udtf5rnduiwXbdxEld3n/k4WkNXa+lycBb0/c/zSJTN4Ec8L4YjhNxNPZL11bjU7yDj7GpUSTqIpADfziux1kYgFUJ+Fbskch0Yh4ewruNIFGaQAZ8C8bjXuyKF/AivsBvicAAHIxxuBT9cTcekdyrLIm+dYKHK/EwvsMEPIpl2JDAbcaf+AFv4HUMxdX4G+9ja3v7KIs7FtWMpV/ZE0h2Ku5HRwK/onIjv6MZ0p/hikR6Mr7GzLIAanahDJDBmI29cSa+rAa+YCzsjzniFMZiTVdjq1mfsszTosfgge6Ar9zL3F+JB3EETi8LoiyBVpwjfH12d8BXsdeE241V8nksS2BPHIkF+LlW8JnfrsGHIgQPYvuZvC4Cmcn3SAt+Wcv4AuvE8jTf4DITlDmBVlyI3bCeurPpqkRgctqUphMYgWswA6+WRZ0h/TymiWQ4uicIDMWOeAI/lSWQsbUic28RcqPpBLYI30XD5PFOQnKs6wkCa9P3XtQeNarYIWlTvu8JAivwO0ZWLpQhkRnTD2PwI77tCQIrReweJ+J3PdaKy0UmniPkd9MJ/IXHhAs9jQOp7RQyvx0tpMhHac6arWwmnoMbcJgQcmXtDCHmJmIpTRZzmck7hQT+SGiiXejeKWR+s7vw/Q5R/JSymk8gQ2K9iN8jcEKJtY/DMMyVauQyIbkeOQ2zxIM3ATvQ9Slk7rWK0nK1UKSlrZSEXdyxSHv7KPhVhMEJIgwugaLyMEfsPNyEqXiF8gmx3hOAp7AQd4gC5z+Ac+APw13C75+sd/HSBDI7tk4oyRZR0B9dBTi04XGhOicrWUY2hEDOFmIS9hXq8vgCEseKh/4g0T+a14iF6yKQ27mZuFiE1GsL5r5AFC2XCileNEfPEiiwb0Q/qMi2pE/NcqFpBHI+vjNuxRBR6HTmfj5XhM+7hasVzVGz1dMXytqhuB3nigf5FmwkXCSN6Suek3uwGLfhPVEHbLNaXapbBKqA3kn0O88UeWCgEGZTJTeqgMlJ54sxRfRLn8VzIqT+kV+gO2S6JFAAfKBop5ySPkeIDDw/gX+7sqNdtBalcTfi7IThE9E3nS/a7+u7S6SQQAHwIaJtPh5HiYbtF3hTNGs7RAO3ywVz87aKvHCGEHWHpxP6BC8LmbJse0RatrPIbrhMdCEOSLszS8TwrxREnO4ce8EGDRDCboxwyTbRMHtSZPrV1eZv6WLio3AfThYvI6aLY15XBnQ3iRB55ETRfj8NH+BmVV6ItFSZ7CSR8ncVYe8ZNfhlg8j0x/lCY+0gip5tbfjK+kXvB0aKY9ssfP6tZgLPz5shsjFt3OdpM6fjlzyeltygwUKvDE/gG/Ieq4zlTqQt4VorgsnqCqZ8Jr5ICLEpvQm+YM0luDMRuSR7I0tgkGhxLBaKstfAV1l7pmjnXyLq6SCQOaoRotiYId4u9ir4AhIb8JLo4rURbpY9gRHireKC3gbdhS1KGNsqF7JRaJjo1S+vXGhQ37ORtkJUcUPzBPoInbMLrhLdt4b9j6JBtlXkhoFCIfRBZ5bAUuwjep7/N/BZEkuFRuqbJbBZZLxGV2jNsk7pLwrZZ2BTubl61/4FsR6JKpzlaNkAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTktMDEtMDlUMDM6NTU6MjIrMDg6MDDkMab6AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE5LTAxLTA5VDAzOjU1OjIyKzA4OjAwlWweRgAAAEN0RVh0c29mdHdhcmUAL3Vzci9sb2NhbC9pbWFnZW1hZ2ljay9zaGFyZS9kb2MvSW1hZ2VNYWdpY2stNy8vaW5kZXguaHRtbL21eQoAAABTdEVYdHN2Zzpjb21tZW50ACBHZW5lcmF0b3I6IFNrZXRjaCAzLjAuMyAoNzg5MSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggbh/q1QAAABB0RVh0c3ZnOnRpdGxlAFBlcnNvbjwcGLsAAAAYdEVYdFRodW1iOjpEb2N1bWVudDo6UGFnZXMAMaf/uy8AAAAYdEVYdFRodW1iOjpJbWFnZTo6SGVpZ2h0ADI0NvDYdVgAAAAXdEVYdFRodW1iOjpJbWFnZTo6V2lkdGgAMjQx/U2wpgAAABl0RVh0VGh1bWI6Ok1pbWV0eXBlAGltYWdlL3BuZz+yVk4AAAAXdEVYdFRodW1iOjpNVGltZQAxNTQ2OTc3MzIyCp5w8AAAABF0RVh0VGh1bWI6OlNpemUANjg1N0Kg2mwTAAAAYnRFWHRUaHVtYjo6VVJJAGZpbGU6Ly8vaG9tZS93d3dyb290L25ld3NpdGUvd3d3LmVhc3lpY29uLm5ldC9jZG4taW1nLmVhc3lpY29uLmNuL2ZpbGVzLzExOS8xMTk4NTgxLnBuZ+cNqJ8AAAAASUVORK5CYII=",width:"18px"}}),t._v(" "),s("span",{domProps:{innerHTML:t._s(e.name)}})])]}))],2)])])]),t._v(" "),s("el-drawer",{attrs:{visible:t.drawerShow,"append-to-body":!0,"show-close":!1,direction:"rtl"},on:{"update:visible":function(e){t.drawerShow=e}}},[s("h3",{staticClass:"title-head",attrs:{slot:"title"},slot:"title"},[t._v("属性编辑栏")]),t._v(" "),s("el-form",{ref:"form",staticClass:"attr-form",attrs:{model:t.form,"label-width":"80px"}},[s("div",{staticClass:"tab-container"},[s("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"节点信息",name:"nodeInfo"}},[s("el-form-item",{attrs:{label:"节点ID"}},[s("el-input",{staticStyle:{width:"50px"},attrs:{disabled:!0},model:{value:t.form.process_id,callback:function(e){t.$set(t.form,"process_id",e)},expression:"form.process_id"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"步骤名称"}},[s("el-input",{model:{value:t.form.process_name,callback:function(e){t.$set(t.form,"process_name",e)},expression:"form.process_name"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"步骤尺寸"}},[s("el-col",{attrs:{span:11}},[s("el-input",{model:{value:t.form.style_width,callback:function(e){t.$set(t.form,"style_width",e)},expression:"form.style_width"}})],1),t._v(" "),s("el-col",{staticClass:"line",attrs:{span:2}},[t._v(" X ")]),t._v(" "),s("el-col",{attrs:{span:11}},[s("el-input",{model:{value:t.form.style_height,callback:function(e){t.$set(t.form,"style_height",e)},expression:"form.style_height"}})],1)],1)],1),t._v(" "),s("el-tab-pane",{attrs:{label:"节点属性",name:"nodeAttr"}},[s("el-form-item",{attrs:{label:"步骤类型"}},[s("el-radio-group",{model:{value:t.form.process_type,callback:function(e){t.$set(t.form,"process_type",e)},expression:"form.process_type"}},[s("el-radio",{attrs:{label:"is_step"}},[t._v("正常步骤")]),t._v(" "),s("el-radio",{attrs:{label:"is_one"}},[t._v("第一步")])],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"调用方法"}},[s("el-input",{model:{value:t.form.wf_action,callback:function(e){t.$set(t.form,"wf_action",e)},expression:"form.wf_action"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"会签方式"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.is_sing,callback:function(e){t.$set(t.form,"is_sing",e)},expression:"form.is_sing"}},t._l(t.options_sing,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),s("el-form-item",{attrs:{label:"回退方式"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.is_back,callback:function(e){t.$set(t.form,"is_back",e)},expression:"form.is_back"}},t._l(t.options_back,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),t._v(" "),s("el-tab-pane",{attrs:{label:"节点人员",name:"nodePeople"}},[s("el-form-item",{attrs:{label:"办理人员"}},[s("el-select",{attrs:{placeholder:"请选择"},on:{change:t.selectedAutoPerson},model:{value:t.form.auto_person,callback:function(e){t.$set(t.form,"auto_person",e)},expression:"form.auto_person"}},[t._l(t.manager,(function(e){return["is_one"==t.form.process_type?["3"!=e.value?s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}}):t._e()]:[s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})]]}))],2)],1),t._v(" "),"6"!=t.form.auto_person?s("el-row",[s("el-col",{staticClass:"selected-manager",attrs:{span:6}},[s("h3",[t._v(t._s(t.managerInfo))]),t._v(" "),s("el-button",{on:{click:t.selectManager}},[t._v("选择")])],1),t._v(" "),s("el-col",{attrs:{span:18}},["3"==t.form.auto_person?s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.rangeUserText,height:"450"}},[s("el-table-column",{attrs:{prop:"date",label:"序号",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                  "+t._s(e.$index)+"\n                  ")]}}],null,!1,1962143971)}),t._v(" "),s("el-table-column",{attrs:{prop:"name",label:"姓名",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                  "+t._s(e.row)+"\n                  ")]}}],null,!1,1559426035)})],1):t._e(),t._v(" "),"4"==t.form.auto_person?s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.autoSponsorText,height:"450"}},[s("el-table-column",{attrs:{prop:"date",label:"序号",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(e.$index)+"\n                  ")]}}],null,!1,2309370211)}),t._v(" "),s("el-table-column",{attrs:{prop:"name",label:"姓名",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(e.row)+"\n                  ")]}}],null,!1,557690995)})],1):t._e(),t._v(" "),"5"==t.form.auto_person?s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.autoRoleText,height:"450"}},[s("el-table-column",{attrs:{prop:"date",label:"序号",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(e.$index)+"\n                  ")]}}],null,!1,2309370211)}),t._v(" "),s("el-table-column",{attrs:{prop:"name",label:"姓名",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(e.row)+"\n                  ")]}}],null,!1,557690995)})],1):t._e()],1)],1):s("el-row",[s("el-col",{staticStyle:{"padding-top":"12px"},attrs:{span:6}},[t._v("事务接受：")]),t._v(" "),s("el-col",{attrs:{span:18}},[s("el-form-item",{attrs:{label:"取业务表"}},[s("el-col",{attrs:{span:11}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.work_text,callback:function(e){t.$set(t.form,"work_text",e)},expression:"form.work_text"}},t._l(t.tableFields,(function(t){return s("el-option",{key:t.field_name,attrs:{label:t.field_text,value:t.field_name}})})),1)],1),t._v(" "),s("el-col",{staticClass:"line",attrs:{span:2}},[t._v(" 的 ")]),t._v(" "),s("el-col",{attrs:{span:11}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.work_ids,callback:function(e){t.$set(t.form,"work_ids",e)},expression:"form.work_ids"}},t._l(t.workIds,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1)],1)],1)],1),t._v(" "),s("el-tab-pane",{attrs:{label:"节点转出",name:"nodeSend"}},[s("el-form-item",{attrs:{label:"步骤模式"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.wf_mode,callback:function(e){t.$set(t.form,"wf_mode",e)},expression:"form.wf_mode"}},t._l(t.stepData,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),"1"==t.form.wf_mode?s("div",[s("table",{staticClass:"table-step"},[s("thead",[s("tr",[s("th",{staticStyle:{width:"50px"}},[t._v("步骤")]),s("th",[t._v("转出条件设置")])])]),t._v(" "),s("tbody",t._l(t.form.process_in_set,(function(e){return s("tr",{key:"step"+e.id},[s("td",{staticStyle:{width:"30px"}},[t._v("步骤"+t._s(e.id))]),t._v(" "),s("td",[s("table",{staticClass:"table table-condensed"},[s("tbody",[s("tr",[s("td",[s("select",{staticClass:"smalls",staticStyle:{width:"120px"},attrs:{"data-step":e.id,name:"field"},on:{change:t.setProcessOutDataField}},[s("option",{attrs:{value:""}},[t._v("选择字段")]),t._v(" "),t._l(t.tableFields,(function(o){return s("option",{key:"fields"+e.id+o.field_name,domProps:{value:o.field_name}},[t._v(t._s(o.field_text))])}))],2),t._v(" "),s("select",{staticClass:"smalls",staticStyle:{width:"60px"},attrs:{name:"con","data-step":e.id},on:{change:t.setProcessOutDataField}},[s("option",{attrs:{value:""}},[t._v("选择条件")]),t._v(" "),t._l(t.outCondition,(function(e){return s("option",{domProps:{value:e.value}},[t._v(t._s(e.label))])}))],2),t._v(" "),s("input",{staticClass:"smalls",staticStyle:{width:"80px"},attrs:{type:"text",name:"value","data-step":e.id},on:{change:t.setProcessOutDataField}}),t._v(" "),s("select",{staticClass:"smalls",staticStyle:{width:"80px"},attrs:{name:"logic","data-step":e.id},on:{change:t.setProcessOutDataField}},[s("option",{attrs:{value:""}},[t._v("选择逻辑")]),t._v(" "),t._l(t.outConditionLogic,(function(e){return s("option",{domProps:{value:e.value}},[t._v(t._s(e.label))])}))],2)]),t._v(" "),s("td",[s("button",{staticClass:"wf_btn",attrs:{type:"button"},on:{click:function(s){return t.addLeftParenthesis(e.id)}}},[t._v("（")]),t._v(" "),s("button",{staticClass:"wf_btn",attrs:{type:"button"},on:{click:function(s){return t.addRightParenthesis(e.id)}}},[t._v("）")]),t._v(" "),s("button",{staticClass:"wf_btn",attrs:{type:"button"},on:{click:function(s){return t.addConditions(e.id)}}},[t._v("新增")])])]),t._v(" "),s("tr",[s("td",[s("select",{directives:[{name:"model",rawName:"v-model",value:t.selCon,expression:"selCon"}],staticStyle:{width:"100%",height:"160px"},attrs:{multiple:""},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selCon=e.target.multiple?s:s[0]}}},t._l(e.condition,(function(e){return s("option",{key:"from_data"+e,domProps:{value:e}},[t._v(t._s(e))])})),0)]),t._v(" "),s("td",[s("button",{staticClass:"wf_btn",attrs:{type:"button"},on:{click:function(s){return t.delCon(e.id)}}},[t._v("删行")]),t._v(" "),s("button",{staticClass:"wf_btn",attrs:{type:"button"},on:{click:function(s){return t.clearCon(e.id)}}},[t._v("清空")])])])])])])])})),0)])]):t._e()],1),t._v(" "),s("el-tab-pane",{attrs:{label:"节点事务",name:"nodeTrans"}},[s("div",{staticClass:"node-trans"},[s("table",{staticClass:"trans-tables"},[s("tbody",[s("tr",[s("td",{staticStyle:{display:"table-cell","vertical-align":"middle"},attrs:{width:"160px"}},[t._v("事务SQL\n                "),s("hr"),t._v("\n                单据ID：@from_id"),s("br"),t._v("\n                节点ID：@run_id"),s("br"),t._v("\n                提交意见：@check_con\n\n              ")]),s("td",[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.work_sql,expression:"form.work_sql"}],staticStyle:{width:"100%",height:"100px"},attrs:{name:"work_sql",type:"text/plain"},domProps:{value:t.form.work_sql},on:{input:function(e){e.target.composing||t.$set(t.form,"work_sql",e.target.value)}}}),t._v("\n                Tip:UPDATE Table SET field1=value1 WHERE id=@run_id;\n              ")])]),t._v(" "),s("tr",[s("td",{staticStyle:{display:"table-cell","vertical-align":"middle"}},[t._v("事务MSG\n                "),s("hr"),t._v("\n                单据ID：@from_id"),s("br"),t._v("\n                节点ID：@run_id"),s("br"),t._v("\n                提交意见：@check_con\n              ")]),s("td",[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.work_msg,expression:"form.work_msg"}],staticStyle:{width:"100%",height:"100px"},attrs:{name:"work_msg",type:"text/plain"},domProps:{value:t.form.work_msg},on:{input:function(e){e.target.composing||t.$set(t.form,"work_msg",e.target.value)}}}),t._v("\n                Tip:您好,您有需要审批的业务,业务编号为：@run_id;\n              ")])])])])])])],1),t._v(" "),s("el-form-item",{staticClass:"save-attr-btn",attrs:{size:"large"}},[s("el-button",{attrs:{type:"primary"},on:{click:t.saveAttr}},[t._v("保存")]),t._v(" "),s("el-button",{on:{click:function(e){t.drawerShow=!1}}},[t._v("取消")])],1)],1)])],1),t._v(" "),s("el-dialog",{attrs:{title:"选择办理对象",visible:t.open,width:"700px",height:"800px","append-to-body":""},on:{"update:visible":function(e){t.open=e}}},[s("div",{staticClass:"select-dialog"},[s("el-col",{attrs:{span:11}},[s("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:t.managerKey,callback:function(e){t.managerKey=e},expression:"managerKey"}})],1),t._v(" "),s("el-col",{attrs:{span:11}},[s("el-button",{staticClass:"search",attrs:{type:"success",size:"mini",plain:""},on:{click:t.getSelectManageData}},[t._v("搜索")])],1),t._v(" "),s("div",{staticClass:"transfer-selector"},[s("el-transfer",{attrs:{props:{key:"value",label:"label"},data:t.ManagerData},model:{value:t.managerValue,callback:function(e){t.managerValue=e},expression:"managerValue"}})],1),t._v(" "),s("div",{staticClass:"save-selected"},[s("el-button",{attrs:{type:"primary",size:"normal",plain:""},on:{click:t.managerSelectedOk}},[t._v("确定")])],1)],1)])],1)},i=[],l=(s("20d6"),s("7f7f"),s("a481"),s("6762"),s("2fdb"),s("ac6a"),s("28a5"),s("e193")),c=s("2ef0"),u=s.n(c),d={name:"Workflow",jsPlumb:null,props:{processList:Array,tableFields:Array,ManagerData:Array,processStep:Array},data:function(){return{dragPos:{startL:0,startT:0,endL:0,endT:0},timeOut:0,selCon:[],processOutData:[],stepData:[],managerKey:"",rangeUserText:[],autoSponsorText:[],autoRoleText:[],managerTitle:"",jsPlumbInit:!1,drawerShow:!1,open:!1,managerValue:[],activeName:"nodeInfo",outCondition:[{label:"=",value:"="},{label:"<>",value:"<>"},{label:">",value:">"},{label:"<",value:"<"},{label:">=",value:">="},{label:"<=",value:"<="},{label:"含",value:"include"},{label:"不含",value:"exclude"}],outConditionLogic:[{label:"AND",value:"AND"},{label:"OR",value:"OR"}],workIds:[{label:"制单人员",value:"1"}],options_sing:[{label:"允许会签",value:"1"},{label:"禁止会签",value:"2"}],options_back:[{label:"允许回退",value:"1"},{label:"禁止回退",value:"2"}],manager:[{label:"自由选择",value:"3"},{label:"指定人员",value:"4"},{label:"指定角色",value:"5"},{label:"事务接受",value:"6"}],form:{flow_id:0,process_id:0,process_name:"",style_width:120,style_height:"auto",process_type:"is_step",wf_action:"view",is_sing:"1",is_back:"1",auto_person:"4",range_user_ids:"",range_user_text:"",auto_sponsor_ids:"",auto_sponsor_text:"",auto_role_ids:"",auto_role_text:"",work_text:"",work_ids:"1",wf_mode:"0",process_in_set:[],work_sql:"",work_msg:"",process_condition:""},connection:{},canvasDataRoom:100}},mounted:function(){this.$options.jsPlumb=l["jsPlumb"].getInstance(),this.initJsPlumb(),this.initFlow()},computed:{processListTmp:{get:function(){return this.processList},set:function(t){this.$emit("setProcessList",t)}},managerInfo:{get:function(){return this.managerTitle},set:function(t){var e="";this.manager.some((function(s){return s.value==t&&(e=s.label,!0)})),this.managerTitle=e}},canvasRoomMinusEnable:function(){return this.canvasDataRoom>50},canvasRoomPlusEnable:function(){return this.canvasDataRoom<100},canvasRoomScaleStyle:function(){return{transform:"scale("+this.canvasDataRoom/100+")"}}},methods:{initFlow:function(){var t=this;t.$options.jsPlumb.bind("click",(function(e,s){t.$confirm("确定删除所点击的链接吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$options.jsPlumb.deleteConnection(e),delete t.connection[e.sourceId+"_"+e.targetId],t.processListTmp.some((function(t,s){if("window"+t.id==e.sourceId){var o=t.process_to.split(",");return o.forEach((function(s,n){"window"+s==e.targetId&&(o.splice(n,1),t.process_to=o.join(","))})),!0}})),t.$nextTick((function(){t.clearJsPlumb(),t.reDraw()}))})).catch((function(t){}))}))},reDraw:function(){var t=this;t.processListTmp.forEach((function(e){if(e.process_to){var s=e.process_to.split(",");s.forEach((function(s){t.draggableFlowConnect("window"+e.id,"window"+s,!0)}))}t.$options.jsPlumb.isSource("flag"+e.id)||t.$options.jsPlumb.makeSource("flag"+e.id,{parent:"window"+e.id,anchor:"Continuous",endpoint:["Dot",{radius:1}],connector:["Flowchart",{stub:[5,5]}],dragOptions:{},maxConnections:-1}),t.$options.jsPlumb.isTarget("window"+e.id)||t.$options.jsPlumb.makeTarget("window"+e.id,{dropOptions:{hoverClass:"hover",activeClass:"active"},anchor:"Continuous",maxConnections:-1,endpoint:["Dot",{radius:1}],paintStyle:{fillStyle:"#ec912a",radius:1},beforeDrop:function(e){if(e.sourceId==e.targetId)return!1;var s=0;return t.processListTmp.every((function(t){var o=t.process_to.split(",");return o=o.map((function(t){return t="window"+t,t})),"flag"+t.id!=e.sourceId||!o.includes(e.targetId)||(s++,!1)})),s>0?(t.msgError("步骤连接重复"),!1):(t.processListTmp.map((function(t,s){if("flag"+t.id==e.sourceId){var o=t.process_to.split(",");o.push(e.targetId.substr(6)),o=o.filter((function(t){return""!=t})),t.process_to=o.join(",")}})),t.$nextTick((function(){t.clearJsPlumb(),t.reDraw()})),!1)}}),t.$options.jsPlumb.draggable("window"+e.id,{containment:"parent",start:function(e){t.dragPos.startL=e.el.offsetLeft,t.dragPos.startT=e.el.offsetTop},stop:function(e){t.dragPos.endL=e.el.offsetLeft,t.dragPos.endT=e.el.offsetTop}})}))},initJsPlumb:function(){var t=this;t.$options.jsPlumb.ready((function(){t.jsPlumbInit=!0,t.$options.jsPlumb.importDefaults({ConnectionsDetachable:!1,LogEnabled:!0,ConnectionOverlays:[["Arrow",{location:1,visible:!0,width:11,length:11,id:"ARROW",events:{click:function(){}}}],["Label",{location:.1,id:"label",cssClass:"aLabel",events:{tap:function(){}},visible:!0}]],Connector:"Flowchart",Container:"module",DoNotThrowErrors:!1,DragOptions:{cursor:"pointer",zIndex:2e3},DropOptions:{},Endpoint:"Dot",Endpoints:[null,null],EndpointOverlays:[],EndpointStyle:{stroke:"#1565C0",strokeWidth:1},EndpointStyles:[null,null],EndpointHoverStyle:{stroke:"#f00",strokeWidth:1},EndpointHoverStyles:[null,null],HoverPaintStyle:{stroke:"#f00",strokeWidth:2},LabelStyle:{color:"black"},Overlays:[],MaxConnections:10,PaintStyle:{stroke:"#1565C0",strokeWidth:1,joinstyle:"round"},ReattachConnections:!0,RenderMode:"svg",Scope:"jsPlumb_DefaultScope",reattach:!0})}))},draggableFlowConnect:function(t,e,s){var o=this;function n(){if(o.jsPlumbInit){var s=t+"_"+e;o.connection[s]&&o.$options.jsPlumb.deleteConnection(o.connection[s]),o.connection[s]=o.$options.jsPlumb.connect({source:t,target:e,endpoint:"Dot",connectorStyle:{strokeStyle:"#ccc",joinStyle:"round",outlineColor:"#ccc"},connector:["Flowchart",{stub:[10,20],gap:1,cornerRadius:2,alwaysRespectStubs:!0}],endpointStyle:{fill:"transparent",outlineStroke:"transparent",outlineWidth:2},paintStyle:{stroke:"lightgray",strokeWidth:2},anchor:"Continuous",overlays:[["PlainArrow",{width:10,length:10,location:1}],["Custom",{location:.5,id:"nodeTempSmall",create:function(){var s=o.$refs[e][0].$el;return s.dataset.target=e,s.dataset.source=t,s},visible:!1}],["Label",{cssClass:"flow-component flow-label",label:t.substr(6)+" - "+e.substr(6)}]]})}}s?n():this.$nextTick((function(){n()}))},handleMinusCanvas:function(){this.canvasDataRoom<=50||(this.canvasDataRoom=this.canvasDataRoom-10)},handlePlusCanvas:function(){100!==this.canvasDataRoom&&(this.canvasDataRoom=this.canvasDataRoom+10)},resetForm:function(){this.form={flow_id:0,process_id:0,process_name:"",style_width:120,style_height:"auto",process_type:"is_step",wf_action:"view",is_sing:"1",is_back:"1",auto_person:"4",range_user_ids:"",range_user_text:"",auto_sponsor_ids:"",auto_sponsor_text:"",auto_role_ids:"",auto_role_text:"",work_text:"",work_ids:"1",wf_mode:"0",process_in_set:[],work_sql:"",work_msg:"",process_condition:""}},showAttr:function(t){var e=this,s=!0;if((Math.abs(this.dragPos.startL-this.dragPos.endL)>5||Math.abs(this.dragPos.startT-this.dragPos.endT)>5)&&(s=!1),this.dragPos={startL:0,startT:0,endL:0,endT:0},!s)return!1;clearTimeout(this.timeOut),this.timeOut=setTimeout((function(){e.resetForm(),e.processListTmp.some((function(s){if(s.id==t){e.form.flow_id=s.flow_id,e.form.process_id=s.id,e.form.process_name=s.process.process_name;var o=JSON.parse(s.process.style);e.form.style_width=o.width,e.form.style_height=o.height,e.form.process_type=s.process.process_type,e.form.is_sing=""+s.process.is_sing,e.form.is_back=""+s.process.is_back,e.form.auto_person=""+s.process.auto_person,e.managerInfo=e.form.auto_person,e.rangeUserText=s.process.range_user_text?s.process.range_user_text.split(","):[],e.autoSponsorText=s.process.auto_sponsor_text?s.process.auto_sponsor_text.split(","):[],e.autoRoleText=s.process.auto_role_text?s.process.auto_role_text.split(","):[],e.form.range_user_ids=s.process.range_user_ids,e.form.range_user_text=s.process.range_user_text,e.form.auto_sponsor_ids=s.process.auto_sponsor_ids,e.form.auto_sponsor_text=s.process.auto_sponsor_text,e.form.auto_role_ids=s.process.auto_role_ids,e.form.auto_role_text=s.process.auto_role_text,e.form.work_ids=s.process.work_ids,e.form.work_text=s.process.work_text,e.form.wf_mode=""+s.process.wf_mode;var n=s.process_to?s.process_to.split(","):[];return e.form.process_condition=s.process_to,n.length>1?e.stepData=[{label:"转出模式（符合执行）",value:"1"},{label:"同步模式（均需办理）",value:"2"}]:e.stepData=[{label:"单线模式（流程为直线型单一办理模式）",value:"0"}],e.form.work_sql=s.process.work_sql,e.form.work_msg=s.process.work_msg,!0}return!1})),e.form.process_in_set=[],e.processStep.forEach((function(s){s.prev_id==t&&e.form.process_in_set.push(s)})),e.drawerShow=!0}),300)},deleteNode:function(t){var e=this;clearTimeout(e.timeOut),e.$confirm("确定删除所点击的节点吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$emit("deleteFlowNode",{sourceId:t})})).catch((function(t){}))},clearAllNodes:function(){var t=this;t.$confirm("确定要清空所有的节点吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("clearAllNodes")})).catch((function(t){}))},addProcess:function(){this.$emit("addProcess")},saveProcess:function(){var t=[];this.processListTmp.map((function(e){var s=document.getElementById("window"+e.id).style.left.replace("px",""),o=document.getElementById("window"+e.id).style.top.replace("px","");t.push({id:e.id,left:s,top:o,process_to:e.process_to})})),this.$emit("saveProcess",t)},wfRefresh:function(){this.processListTmp=[],this.$emit("getProcessData")},clearJsPlumb:function(){this.connection={},this.$options.jsPlumb.deleteEveryConnection(),this.$options.jsPlumb.deleteEveryEndpoint(),this.$options.jsPlumb.unmakeEverySource(),this.$options.jsPlumb.unmakeEveryTarget()},selectManager:function(){this.managerKey="",this.managerValue=[],this.getSelectManageData(),this.open=!0},getSelectManageData:function(){var t,e=this.managerKey;"3"==this.form.auto_person||"4"==this.form.auto_person?t="getUser":"5"==this.form.auto_person&&(t="getDepartment"),this.$emit("getManager",{type:t,key:e})},managerSelectedOk:function(){var t=this;"3"==this.form.auto_person?(this.form.range_user_ids=this.managerValue.join(","),this.rangeUserText=[],this.ManagerData.forEach((function(e){t.managerValue.includes(e.value)&&t.rangeUserText.push(e.label)})),this.form.range_user_text=this.rangeUserText.join(",")):"4"==this.form.auto_person?(this.form.auto_sponsor_ids=this.managerValue.join(","),this.autoSponsorText=[],this.ManagerData.forEach((function(e){t.managerValue.includes(e.value)&&t.autoSponsorText.push(e.label)})),this.form.auto_sponsor_text=this.autoSponsorText.join(",")):"5"==this.form.auto_person&&(this.form.auto_role_ids=this.managerValue.join(","),this.autoRoleText=[],this.ManagerData.forEach((function(e){t.managerValue.includes(e.value)&&t.autoRoleText.push(e.label)})),this.form.auto_role_text=this.autoRoleText.join(",")),this.open=!1},setProcessOutDataField:function(t){this.setArrValue(this.processOutData,t.target.dataset.step,t.target.name,t.target.value)},addLeftParenthesis:function(t){var e=u.a.findIndex(this.form.process_in_set,(function(e){return e.id==t}));if(e<0)return this.msgError("请先添加条件，再选择括号"),!1;var s=u.a.findIndex(this.processOutData,(function(e){return e.id==t}));if(s<0||!this.processOutData[s].logic)return this.msgError("请先选择逻辑运算符，再选择括号"),!1;var o=u.a.last(this.form.process_in_set[e].condition);return"AND"==this.trim(o).substr(-3,3)||"OR"==this.trim(o).substr(-2,2)?(this.msgError("无法编辑已经存在关系的条件"),!1):o.indexOf("(")>=0?(this.msgError("条件表达式书写错误,请检查括号匹配"),!1):(o+=" "+this.processOutData[s].logic,this.form.process_in_set[e].condition=u.a.slice(this.form.process_in_set[e].condition,0,this.form.process_in_set[e].condition.length-1),this.form.process_in_set[e].condition.push(o),void this.form.process_in_set[e].condition.push("("))},addRightParenthesis:function(t){var e=u.a.findIndex(this.form.process_in_set,(function(e){return e.id==t}));if(e<0)return this.msgError("请先添加条件，再选择括号"),!1;var s=u.a.last(this.form.process_in_set[e].condition);return"AND"==this.trim(s).substr(-3,3)||"OR"==this.trim(s).substr(-2,2)?(this.msgError("无法编辑已经存在关系的条件"),!1):1==this.trim(s).length?(this.msgError("请添加条件"),!1):void(this.checkExp(s)||(s+=")",this.form.process_in_set[e].condition.splice(this.form.process_in_set[e].condition.length-1,1,s)))},addConditions:function(t){var e=u.a.findIndex(this.processOutData,(function(e){return e.id==t}));if(e<0)return this.msgError("请补充完整条件"),!1;var s=this.processOutData[e].field,o=this.processOutData[e].con,n=this.processOutData[e].value,a=!0;if(!(s&&o&&n))return this.msgError("请补充完整条件"),!1;var r=0,i=u.a.findIndex(this.form.process_in_set,(function(e){return e.id==t}));if(i>=0){this.form.process_in_set[i].condition||(this.form.process_in_set[i].condition=[]);var l=this.form.process_in_set[i].condition;if(l.length>0){r=l.length;var c=l[r-1];this.checkExp(c)||(a=!1)}if(n.indexOf("'")>=0)return void this.msgError("值中不能含有'号");for(var d=""+s+o+" '"+n+"'",f=""+s+o+" '"+n+"'",p=0;p<l.length;p++)if(l[p].indexOf(d)>=0)return void this.msgError("条件重复");var m=this.processOutData[e].logic;if(a){var A=l.length;if(A>0){if(!m||"undefined"==typeof m)return void this.msgError("请选择逻辑运算符");this.form.process_in_set[i].condition[A-1]+=" "+m}this.form.process_in_set[i].condition.push(d)}else{var h=this.form.process_in_set[i];if(1==this.trim(l[r-1]).length)h.condition[r-1]+=f;else{if(!m||"undefined"==typeof m)return void this.msgError("请选择逻辑运算符");h.condition[r-1]+=" "+m+" "+f}this.form.process_in_set.splice(i,1,h)}}},delCon:function(t){var e=this,s=u.a.findIndex(this.form.process_in_set,(function(e){return e.id==t}));if(!(s<0)){this.selCon.length>0?this.selCon.forEach((function(t){var o=u.a.findIndex(e.form.process_in_set[s].condition,(function(e){return t==e}));e.form.process_in_set[s].condition.splice(o,1)})):this.form.process_in_set[s].condition.pop();var o=u.a.last(this.form.process_in_set[s].condition);o&&(o=o.replace(/(AND|OR)$/,""),this.form.process_in_set[s].condition=u.a.slice(this.form.process_in_set[s].condition,0,this.form.process_in_set[s].condition.length-1),this.form.process_in_set[s].condition.push(o))}},clearCon:function(t){var e=u.a.findIndex(this.form.process_in_set,(function(e){return e.id==t}));e<0||(this.form.process_in_set[e].condition=[])},selectedAutoPerson:function(t){this.managerInfo=t},setArrValue:function(t,e,s,o){var n=u.a.findIndex(t,(function(t){return t.id==e}));n<0?t.push(JSON.parse('{"id":"'+e+'","'+s+'":"'+o+'"}')):t[n][s]=o},checkFlow:function(){this.$emit("checkFlow")},saveAttr:function(){this.$emit("doSaveAttr",this.form),this.drawerShow=!1},trim:function(t){return(t+"").replace(/(\s+)$/g,"").replace(/^\s+/g,"")},checkExp:function(t){if(t.indexOf("(")>=0){var e=t.split("(").length,s=t.split(")").length;if(e!=s)return!1}return!0}}},f=d,p=(s("3c4a"),s("2877")),m=Object(p["a"])(f,r,i,!1,null,null,null),A=m.exports,h=s("92bc"),v={name:"gFlow",components:{workFlow:A},data:function(){return{isRouterAlive:!0,processList:[],total:0,flowInfo:{},tableFields:[],manager:[],processStep:[]}},beforeMount:function(){this.getProcessData()},methods:{getProcessData:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.$route.query.id,t.next=3,Object(h["k"])(e).then((function(t){s.flowInfo=t.data.flowInfo;var e=t.data.processList,o=e.some((function(t){return""!=t.process_to}));!o&&e.length>1&&(e[0].process_to=""+e[1].id),s.processList=e,s.total=t.data.total,s.tableFields=t.data.fields,s.processStep=t.data.processStep}));case 3:this.$refs["design"].clearJsPlumb(),this.$refs["design"].reDraw();case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),setProcessList:function(t){this.processList=t},addProcess:function(){var t=this;Object(h["b"])(this.flowInfo.id).then((function(e){0===e.code&&(t.msgSuccess(e.msg),t.reload())}))},saveProcess:function(t){var e=this;Object(h["o"])(t).then((function(t){0===t.code&&(e.msgSuccess(t.msg),e.$refs["design"].wfRefresh())}))},getManager:function(t){var e=this;Object(h["j"])(t).then((function(t){0===t.code&&(e.manager=t.data?t.data:[])}))},doSaveAttr:function(t){var e=this;Object(h["h"])(t).then((function(t){0===t.code&&(e.msgSuccess(t.msg),e.$refs["design"].wfRefresh())}))},deleteFlowNode:function(t){var e=this,s={process_id:t.sourceId,flow_id:this.flowInfo.id};Object(h["g"])(s).then((function(t){0===t.code&&(e.msgSuccess(t.msg),e.reload())}))},clearAllNodes:function(){var t=this;Object(h["e"])({flow_id:this.flowInfo.id}).then((function(e){0===e.code&&(t.msgSuccess(e.msg),t.reload())}))},checkFlow:function(){var t=this;Object(h["d"])({flow_id:this.flowInfo.id}).then((function(e){0===e.code&&t.msgSuccess(e.msg)}))},reload:function(){var t=this;this.isRouterAlive=!1,this.$nextTick((function(){t.isRouterAlive=!0,t.$nextTick((function(){t.$refs["design"].wfRefresh()}))}))}}},_=v,b=Object(p["a"])(_,o,n,!1,null,null,null);e["default"]=b.exports}}]);